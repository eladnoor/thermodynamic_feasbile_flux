% --------------------------------------------------------------
% This is all preamble stuff that you don't have to worry about.
% Head down to where it says "Start here"
% --------------------------------------------------------------
 
\documentclass[12pt]{article}
 
\usepackage[margin=1in]{geometry} 
\usepackage{amsmath,amsthm,amssymb}
\usepackage{url}
 
\newcommand{\N}{\mathbb{N}}
\newcommand{\Z}{\mathbb{Z}}
 
\newenvironment{theorem}[2][Theorem]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}\hskip \labelsep {\bfseries #2.}]}{\end{trivlist}}
\newenvironment{lemma}[2][Lemma]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}\hskip \labelsep {\bfseries #2.}]}{\end{trivlist}}
\newenvironment{exercise}[2][Exercise]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}\hskip \labelsep {\bfseries #2.}]}{\end{trivlist}}
\newenvironment{reflection}[2][Reflection]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}\hskip \labelsep {\bfseries #2.}]}{\end{trivlist}}
\newenvironment{proposition}[2][Proposition]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}\hskip \labelsep {\bfseries #2.}]}{\end{trivlist}}
\newenvironment{corollary}[2][Corollary]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}\hskip \labelsep {\bfseries #2.}]}{\end{trivlist}}
 
\begin{document}
 
% --------------------------------------------------------------
%                         Start here
% --------------------------------------------------------------
 
%\renewcommand{\qedsymbol}{\filledbox}
 
\title{How important is thermodynamics?}%replace X with the appropriate number
\author{Elad Noor\\ %replace with your name
IMSB - ETH Z\"{u}rich} %if necessary, replace with your course title
 
\maketitle

Here, I attempt to rewrite the details and proof of Lemma 1 from Schuster and Heinrich (1991) using Gibbs free energies instead of equilibrium constants.

A reaction $j$ is feasible when:
\begin{equation}
    \Delta_r G'_j = \Delta_r G'^\circ_j + RT \sum_{i=1}^{m} S_{ij} \ln{c_i} < 0
\end{equation}
where $c_i$ is the concentration of metabolite $i$, and $S_{ij}$ is its stoichiometric coefficient in this reaction. Using matrix notation, the conditions for the strict feasibility of all reactions represented in $\mathbf{S}$:
\begin{equation}\label{eq:feasilibilty}
    \mathbf{S}^\top \mathbf{x} \leq -\frac{\mathbf{\Delta_r G'^\circ_j}}{RT}
\end{equation}
where $\mathbf{x} \in \mathbb{R}^m$ is the vector of log concentrations ($x_i = \ln{c_i}$).

We define the convex polyhedral cone of steady-state flux distributions:
\begin{equation}
    \mathcal{K} = \mathbb{R}_+^r \cap \ker(\mathbf{S})\,.
\end{equation}

\begin{lemma}{1}
The linear inequality system Eq (\ref{eq:feasilibilty}) has a solution for $\mathbf{x}$ if and only if the vector $\mathbf{\Delta_r G'^\circ_j}$ fulfills the inequality system
\begin{equation}\label{eq:negative_product}
    \forall \mathbf{v} \in \mathcal{K}~~~~\mathbf{v}^\top~\mathbf{\Delta_r G'^\circ_j} \leq 0\,.
\end{equation}
\end{lemma}
 
\begin{proof}
In the forward direction, if we take an existing solution $\mathbf{x}$ and the multiply Eq (\ref{eq:feasilibilty}) by $\mathbf{v}^\top$, we would get that
$\mathbf{v}^\top \mathbf{S}^\top \mathbf{x} \leq -\mathbf{v}^\top \mathbf{\Delta_r G'^\circ_j}~/~RT$, and if $\mathbf{v} \in \mathcal{K} \subseteq \ker(\mathbf{S})$, the left-hand side will be equal to zero, i.e., $0 \leq -\mathbf{v}^\top \mathbf{\Delta_r G'^\circ_j}$.

In the other direction, according to Duality theory\footnote{From the book by Boyd and Vandenberghe (2004), "Section 5.8.3", we have a simplified version of Farkas' lemma:
\begin{lemma}{Gale}
 If $\mathbf{A}\mathbf{x} \leq \mathbf{b}$ is unsolvable then $\exists \mathbf{y} \geq \mathbf{0}$ such that $\mathbf{y}^\top \mathbf{A} = \mathbf{0}$ and $\mathbf{y}^\top \mathbf{b} = -1$.
\end{lemma}}
, if Eq (\ref{eq:feasilibilty}) has no solutions, then there exists $\mathbf{u} \in \mathbb{R}_+^r$ such that $\mathbf{u}^\top \mathbf{S}^\top = \mathbf{0}$ and $-\mathbf{u}^\top \mathbf{\Delta_r G'^\circ_j}~/~RT = -1$. Therefore $\mathbf{u}$ is in $\mathcal{K}$, but $\mathbf{u}^\top \mathbf{\Delta_r G'^\circ_j} = RT > 0$ which contradicts the the condition in Eq \ref{eq:negative_product}.
\end{proof}


% --------------------------------------------------------------
%     You don't have to mess with anything below this line.
% --------------------------------------------------------------
 
\end{document}